<!-- 添加/编辑孩子页面 -->
<view class="container">
  <view class="header">
    <text class="title">{{mode === 'edit' ? '编辑孩子信息' : '添加孩子信息'}}</text>
    <text class="subtitle">{{mode === 'edit' ? '修改孩子的专属档案' : '为您的孩子创建专属档案'}}</text>
  </view>

  <form bindsubmit="onSubmit" class="form" style="width: 651rpx; display: block; box-sizing: border-box">
    <view class="form-group">
      <text class="label">孩子姓名</text>
      <input class="input" name="name" placeholder="请输入孩子姓名" value="{{formData.name}}" bindinput="onInputChange" data-field="name" />
    </view>

    <view class="form-group">
      <text class="label">头像</text>
      <view class="avatar-section">
        <view class="current-avatar">
          <image class="avatar-preview" src="{{formData.avatar || '/images/default-avatar.png'}}" mode="aspectFill" />
          <text class="avatar-tip">点击下方选择头像或上传自定义头像</text>
        </view>
        
        <!-- 上传自定义头像按钮 -->
        <view class="upload-section">
          <button class="upload-btn" bindtap="onUploadAvatar">
            <text class="upload-icon">📷</text>
            <text class="upload-text">上传自定义头像</text>
          </button>
        </view>
        
        <view class="avatar-grid">
          <view 
            wx:for="{{avatarList}}" 
            wx:key="path"
            class="avatar-item {{formData.avatar === item.path ? 'selected' : ''}}"
            bindtap="onAvatarSelect"
            data-avatar="{{item.path}}"
          >
            <image class="avatar-thumb" src="{{item.path}}" mode="aspectFill" />
            <view wx:if="{{formData.avatar === item.path}}" class="avatar-check">✓</view>
          </view>
        </view>
      </view>
    </view>

    <view class="form-group">
      <text class="label">性别</text>
      <radio-group name="gender" bindchange="onGenderChange">
        <label class="radio-item">
          <radio value="male" checked="{{formData.gender === 'male'}}" />
          <text>男孩 👦</text>
        </label>
        <label class="radio-item">
          <radio value="female" checked="{{formData.gender === 'female'}}" />
          <text>女孩 👧</text>
        </label>
      </radio-group>
    </view>

    <view class="form-group">
      <text class="label">生日</text>
      <picker mode="date" value="{{formData.birthday}}" bindchange="onBirthdayChange">
        <view class="picker">
          <text>{{formData.birthday || '请选择生日'}}</text>
          <text class="picker-arrow">▼</text>
        </view>
      </picker>
    </view>

    <view class="form-group" wx:if="{{formData.age}}">
      <text class="label">年龄</text>
      <view class="age-display">
        <text class="age-text">{{formData.age}}岁</text>
        <text class="age-tip">根据生日自动计算</text>
      </view>
    </view>

    <view class="form-group">
      <text class="label">兴趣爱好</text>
      <input class="input" name="interests" placeholder="如：画画、足球、阅读等" value="{{formData.interests}}" bindinput="onInputChange" data-field="interests" />
    </view>

    <view class="button-group">
      <button class="cancel-btn" bindtap="onCancel">取消</button>
      <button class="submit-btn" form-type="submit" disabled="{{!canSubmit}}">{{mode === 'edit' ? '更新' : '保存'}}</button>
    </view>
  </form>
</view>