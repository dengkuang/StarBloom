<!-- å¥–åŠ±å•†åº—é¡µé¢ç»“æ„ -->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜å’Œæ“ä½œæŒ‰é’® -->
  <view class="page-header">
    <text class="page-title">å¥–åŠ±å•†åº—</text>
    <view class="header-actions">
      <button class="filter-button" bindtap="toggleFilterPanel">
        <text class="filter-icon">âš¡</text>
        <text>ç­›é€‰</text>
      </button>
      <button class="add-button" bindtap="navigateToAddReward">
        <text class="add-icon">+</text>
        <text>æ·»åŠ </text>
      </button>
    </view>
  </view>

  <!-- ç­›é€‰é¢æ¿ -->
  <view class="filter-panel" wx:if="{{showFilterPanel}}">
    <view class="filter-group">
      <text class="filter-label">é€‰æ‹©å„¿ç«¥:</text>
      <picker 
        range="{{filterOptions.children}}" 
        range-key="name" 
        value="{{filters.childId}}" 
        bindchange="onFilterChange" 
        data-field="childId">
        <view class="filter-value">
          {{filterOptions.children && filterOptions.children[filters.childId] && filterOptions.children[filters.childId].name ? filterOptions.children[filters.childId].name : 'å…¨éƒ¨å„¿ç«¥'}}
        </view>
      </picker>
    </view>

    <view class="filter-group">
      <text class="filter-label">å¥–åŠ±çŠ¶æ€:</text>
      <picker 
        range="{{filterOptions.statuses}}" 
        range-key="name" 
        value="{{filters.status}}" 
        bindchange="onFilterChange" 
        data-field="status">
        <view class="filter-value">
          {{filterOptions.statuses && filterOptions.statuses[filters.status] && filterOptions.statuses[filters.status].name ? filterOptions.statuses[filters.status].name : 'å…¨éƒ¨çŠ¶æ€'}}
        </view>
      </picker>
    </view>

    <view class="filter-group">
      <text class="filter-label">å¥–åŠ±ç±»å‹:</text>
      <picker 
        range="{{filterOptions.types}}" 
        range-key="name" 
        value="{{filters.type}}" 
        bindchange="onFilterChange" 
        data-field="type">
        <view class="filter-value">
          {{filterOptions.types && filterOptions.types[filters.type] && filterOptions.types[filters.type].name ? filterOptions.types[filters.type].name : 'å…¨éƒ¨ç±»å‹'}}
        </view>
      </picker>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading && rewardList.length === 0}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">å¥–åŠ±åŠ è½½ä¸­...</text>
  </view>

  <!-- é”™è¯¯æç¤º -->
  <view class="error-container" wx:if="{{error}}">
    <text class="error-text">{{error}}</text>
    <button class="retry-button" bindtap="onRetry">é‡è¯•</button>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-container" wx:if="{{!loading && rewardList.length === 0 && !error}}">
    <text class="empty-icon">ğŸ</text>
    <text class="empty-text">æš‚æ— å¥–åŠ±</text>
    <text class="empty-subtext">ç‚¹å‡»"æ·»åŠ "æŒ‰é’®åˆ›å»ºç¬¬ä¸€ä¸ªå¥–åŠ±</text>
  </view>

  <!-- å¥–åŠ±åˆ—è¡¨ -->
  <view class="reward-list" wx:if="{{!loading && rewardList.length > 0}}">
    <view class="list-header">
      <text class="list-title">å¥–åŠ±åˆ—è¡¨ ({{rewardList.length}})</text>
    </view>

    <reward-item 
      wx:for="{{rewardList}}" 
      wx:key="_id" 
      reward="{{item}}" 
      bind:exchange="onExchangeReward"
      bind:edit="onEditReward"
      bind:delete="onDeleteReward">
    </reward-item>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more" wx:if="{{hasMore}}">
      <text class="load-more-text" bindtap="onReachBottom">åŠ è½½æ›´å¤š...</text>
    </view>

    <view class="no-more" wx:else>
      <text class="no-more-text">æ²¡æœ‰æ›´å¤šå¥–åŠ±äº†</text>
    </view>
  </view>
</view>