<!-- å­©å­é€‰æ‹©å™¨ç»„ä»¶ -->
<view class="child-selector-container">
  <!-- å½“å‰é€‰ä¸­çš„å­©å­æ˜¾ç¤ºåŒºåŸŸ -->
  <view class="current-child-display" bind:tap="toggleExpanded">
    <image 
      class="child-avatar" 
      src="{{currentChild.avatar || '/images/default-avatar.png'}}" 
      mode="aspectFill"
    ></image>
    <view class="child-info">
      <text class="child-name">{{currentChild.name || 'è¯·é€‰æ‹©å­©å­'}}</text>
      <text class="child-details" wx:if="{{currentChild.name}}">
        {{currentChild.gender === 'male' ? 'ğŸ‘¦' : 'ğŸ‘§'}} {{currentChild.age}}å²
        <text wx:if="{{showPoints}}" class="current-points"> â€¢ {{currentChild.totalPoints || 0}}åˆ†</text>
      </text>
    </view>
    <text class="selector-arrow {{isExpanded ? 'rotate' : ''}}">â–¼</text>
  </view>

  <!-- å±•å¼€çš„å­©å­åˆ—è¡¨ -->
  <view class="child-list {{isExpanded ? 'show' : ''}}" wx:if="{{childrenList.length > 1}}">
    <scroll-view 
      class="child-scroll-view" 
      scroll-y="{{true}}" 
      enhanced="{{true}}"
      show-scrollbar="{{true}}"
      scroll-with-animation="{{true}}"
      bindscroll="onScrollViewScroll"
      bindscrolltoupper="onScrollToUpper"
      bindscrolltolower="onScrollToLower"
    >
      <view 
        class="child-item {{item._id === currentChild._id ? 'selected' : ''}}"
        wx:for="{{childrenList}}"
        wx:key="_id"
        wx:for-item="item"
        bind:tap="selectChild"
        data-child-id="{{item._id}}"
      >
        <!-- é€‰ä¸­çŠ¶æ€æŒ‡ç¤ºå™¨ -->
        <view class="check-indicator {{item._id === currentChild._id ? 'checked' : ''}}">
          <text class="check-mark">âœ“</text>
        </view>
        
        <!-- å­©å­å¤´åƒ -->
        <image 
          class="child-avatar-small" 
          src="{{item.avatar || '/images/default-avatar.png'}}" 
          mode="aspectFill"
        ></image>
        
        <!-- å­©å­ä¿¡æ¯ -->
        <view class="child-info-small">
          <text class="child-name-small">{{item.name}}</text>
          <text class="child-details-small">
            {{item.gender === 'male' ? 'ğŸ‘¦' : 'ğŸ‘§'}} {{item.age}}å²
          </text>
        </view>
        
        <!-- ç§¯åˆ†æ˜¾ç¤º -->
        <view class="child-points" wx:if="{{showPoints}}">
          <text class="points-text">{{item.totalPoints || 0}}åˆ†</text>
        </view>

        <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ -->
        <view class="child-actions">
          <view 
            class="action-btn edit-btn" 
            catch:tap="editChild"
            data-child-id="{{item._id}}"
          >
            <text class="action-icon">âœï¸</text>
          </view>
          <view 
            class="action-btn delete-btn" 
            catch:tap="deleteChild"
            data-child-id="{{item._id}}"
          >
            <text class="action-icon">ğŸ—‘ï¸</text>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- é®ç½©å±‚ - ç‚¹å‡»æ”¶èµ·åˆ—è¡¨ -->
  <view 
    class="selector-mask {{isExpanded ? 'show' : ''}}" 
    bind:tap="closeMask"
    wx:if="{{isExpanded}}"
  ></view>
</view>